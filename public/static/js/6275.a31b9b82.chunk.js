"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[6275],{16275:function(e,t,i){i.r(t);var a=i(4942),n=i(1413),s=i(74165),r=i(15861),l=i(70885),o=i(47313),c=i(65832),d=i(21366),u=i(63849),m=i(31616),p=i(93298),h=i(7410),f=i(3463),b=i(24751),g=i(3979),_=i(34491),y=i(58467),Z=i(7155),x=i(89094),j=i.n(x),k=i(76666),v=i.n(k),w=i(46417),C=document.createElement("script");C.type="text/javascript",C.src="https://www.wiris.net/demo/plugins/app/WIRISplugins.js?viewer=image",document.head.appendChild(C),window.$=v(),window.tinymce=i(86821),i(37741);t.default=function(){var e=(0,o.useRef)(null),t=(0,o.useRef)(null),i=(0,o.useRef)(null),x=(0,o.useRef)(null),k=(0,y.UO)(),v=(0,y.s0)(),C=(0,o.useState)(!1),S=(0,l.Z)(C,2),q=S[0],M=S[1],N=(0,o.useState)([]),I=(0,l.Z)(N,2),R=I[0],F=I[1],G=(0,o.useState)([]),E=(0,l.Z)(G,2),L=E[0],A=E[1],B=(0,o.useState)([]),T=(0,l.Z)(B,2),V=T[0],z=T[1],H=(0,o.useState)([]),P=(0,l.Z)(H,2),O=P[0],Y=P[1],D=(0,o.useState)([]),J=(0,l.Z)(D,2),Q=J[0],U=J[1],W=(0,o.useState)({year:"",subject:"",modules:[],topics:[],subtopics:[],name:"",content:"",permission:2,totalMarks:0,syllabusRef:"",markingCrit:"",sampleSolution:"",tags:[]}),$=(0,l.Z)(W,2),K=$[0],X=$[1],ee=f.Ry({year:f.Z_("Choose a year.").required("Year is required."),subject:f.Z_("Choose a subject.").required("Subject is required"),totalMarks:f.Rx("Total marks must be number.").required("Total marks is required."),syllabusRef:f.Z_("Enter a syllabus reference.").required("Syllabus reference is required.")});(0,o.useEffect)((function(){(0,r.Z)((0,s.Z)().mark((function e(){var t,i,a,n,r,l,o,c,d,u,m,p;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=k.id,e.next=3,b.Z.get("/admin/questions/".concat(t));case 3:if(i=e.sent,(a=i.data).success){for(r in n=a.years.findIndex((function(e){return e._id===a.question.year})),a.modules)for(l in a.modules[r].subject===a.question.subject&&(a.modules[r].shown=!0),a.question.modules)a.modules[r]._id===a.question.modules[l]&&(a.modules[r].checked=!0);for(o in a.topics){for(c in a.question.modules)a.topics[o].module===a.question.modules[c]&&(a.topics[o].shown=!0);for(d in a.question.topics)a.topics[o]._id===a.question.topics[d]&&(a.topics[o].checked=!0)}for(u in a.subtopics){for(m in a.question.topics)a.subtopics[u].topic===a.question.topics[m]&&(a.subtopics[u].shown=!0);for(p in a.question.subtopics)a.subtopics[u]._id===a.question.subtopics[p]&&(a.subtopics[u].checked=!0)}F(a.years),A(a.years.length?a.years[n].subjects:[]),z(a.modules),Y(a.topics),U(a.subtopics),X(a.question)}case 6:case"end":return e.stop()}}),e)})))()}),[]);var te=function(e){var t=R.findIndex((function(t){return t._id===e.target.value}));for(var i in V)V[i].checked=!1,V[i].shown=!1,V[i].subject===R[t].subjects[0]._id&&(V[i].shown=!0);for(var a in O)O[a].checked=!1,O[a].shown=!1;for(var s in Q)Q[s].checked=!1,Q[s].shown=!1;A(R[t].subjects),z(V),Y(O),U(Q),X((0,n.Z)((0,n.Z)({},K),{},{year:e.target.value,subject:R[t].subjects.length?R[t].subjects[0]._id:"",modules:[],topics:[],subtopics:[]}))},ie=function(e){for(var t in V)V[t].checked=!1,V[t].shown=!1,V[t].subject===e.target.value&&(V[t].shown=!0);for(var i in O)O[i].checked=!1,O[i].shown=!1;for(var a in Q)Q[a].checked=!1,Q[a].shown=!1;z(V),Y(O),U(Q),X((0,n.Z)((0,n.Z)({},K),{},{subject:e.target.value,modules:[],topics:[],subtopics:[]}))},ae=function(e){var t=V.findIndex((function(t){return t._id===e.target.value}));for(var i in V[t].checked=e.target.checked,O)if(O[i].module===V[t]._id){if(e.target.checked)O[i].shown=!0;else for(var a in O[i].shown=!1,Q)Q[a].topic===O[i]._id&&(Q[a].shown=!1,Q[a].checked=!1);O[i].checked=!1}var s=[];for(var r in V)V[r].checked&&s.push(V[r]._id);var l=[];for(var o in O)O[o].checked&&l.push(O[o]._id);var c=[];for(var d in Q)Q[d].checked&&c.push(Q[d]._id);z(V),Y(O),U(Q),M(!q),X((0,n.Z)((0,n.Z)({},K),{},{modules:s,topics:l,subtopics:c}))},ne=function(e){var t=O.findIndex((function(t){return t._id===e.target.value}));for(var i in O[t].checked=e.target.checked,Q)Q[i].topic===O[t]._id&&(e.target.checked?Q[i].shown=!0:Q[i].shown=!1,Q[i].checked=!1);var a=[];for(var s in O)O[s].checked&&a.push(O[s]._id);var r=[];for(var l in Q)Q[l].checked&&r.push(Q[l]._id);Y(O),U(Q),M(!q),X((0,n.Z)((0,n.Z)({},K),{},{topics:a,subtopics:r}))},se=function(e){var t=Q.findIndex((function(t){return t._id===e.target.value}));Q[t].checked=e.target.checked;var i=[];for(var a in Q)Q[a].checked&&i.push(Q[a]._id);U(Q),M(!q),X((0,n.Z)((0,n.Z)({},K),{},{subtopics:i}))},re=function(e){X((0,n.Z)((0,n.Z)({},K),{},{permission:Number(e.target.value)}))},le=function(e){X((0,n.Z)((0,n.Z)({},K),{},{syllabusRef:e.target.value}))},oe=function(e){X((0,n.Z)((0,n.Z)({},K),{},{totalMarks:e.target.value}))},ce=function(e){e.length>5||X((0,n.Z)((0,n.Z)({},K),{},{tags:e}))},de=function(){var a=(0,r.Z)((0,s.Z)().mark((function a(n,r){var l,o,c,d;return(0,s.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return l=r.resetForm,o=k.id,n.content=e.current.getContent(),n.name=t.current.getContent(),n.markingCrit=i.current.getContent(),n.sampleSolution=x.current.getContent(),a.next=8,b.Z.put("admin/questions/".concat(o),n);case 8:c=a.sent,(d=c.data).success?(_.Am.success(d.msg),l(),v("/admin/question")):_.Am.error(d.msg);case 11:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}();return(0,w.jsx)(w.Fragment,{children:(0,w.jsxs)(c.Z,{children:[(0,w.jsx)(c.Z.Header,{style:{background:"#3c4b64"},bsPrefix:"card-header py-3",children:(0,w.jsx)(c.Z.Title,{bsPrefix:"card-title mb-0 text-light",as:"h1",children:"Edit question"})}),(0,w.jsx)(c.Z.Body,{children:(0,w.jsx)(h.J9,{validationSchema:ee,validateOnChange:!1,validateOnBlur:!1,onSubmit:de,initialValues:K,enableReinitialize:!0,children:function(n){var s,r,l,o,c=n.handleSubmit,h=(n.handleChange,n.handleBlur),f=n.values,b=n.touched,_=n.errors;return(0,w.jsxs)(d.Z,{noValidate:!0,onSubmit:c,children:[(0,w.jsxs)(u.Z,{children:[(0,w.jsxs)(m.Z,{md:6,children:[(0,w.jsxs)(d.Z.Group,{className:"mb-3",children:[(0,w.jsx)(d.Z.Label,{children:"Year:"}),(0,w.jsx)(d.Z.Select,{name:"year",value:f.year,onChange:te,onBlur:h,touched:b,isInvalid:!!_.year,children:R.map((function(e,t){return(0,w.jsx)("option",{value:e._id,children:e.name},t)}))}),(0,w.jsx)(d.Z.Control.Feedback,{type:"invalid",children:_.year})]}),(0,w.jsxs)(d.Z.Group,{className:"mb-3",children:[(0,w.jsx)(d.Z.Label,{children:"Subject:"}),(0,w.jsx)(d.Z.Select,{name:"subject",value:f.subject,onChange:ie,onBlur:h,touched:b,isInvalid:!!_.subject,children:L.map((function(e,t){return(0,w.jsx)("option",{value:e._id,children:e.name},t)}))}),(0,w.jsx)(d.Z.Control.Feedback,{type:"invalid",children:_.subject})]}),(0,w.jsxs)(d.Z.Group,{className:"mb-3",children:[(0,w.jsx)(d.Z.Label,{children:"Module:"}),(0,w.jsx)("br",{}),(0,w.jsx)(u.Z,{children:V.map((function(e,t){return e.shown&&(0,w.jsx)(m.Z,{sm:6,children:(0,w.jsx)(d.Z.Check,{inline:!0,label:e.name,name:"module-item",value:e._id,type:"checkbox",id:"module-".concat(e._id),checked:e.checked,className:"checkbox-module",onChange:ae})},t)}))}),(0,w.jsx)(d.Z.Control.Feedback,{type:"invalid",children:_.name})]}),(0,w.jsxs)(d.Z.Group,{className:"mb-3",children:[(0,w.jsx)(d.Z.Label,{children:"Topic:"}),(0,w.jsx)("br",{}),(0,w.jsx)(u.Z,{children:O.map((function(e,t){return e.shown&&(0,w.jsx)(m.Z,{sm:6,children:(0,w.jsx)(d.Z.Check,{inline:!0,label:e.name,name:"module-item",value:e._id,type:"checkbox",checked:e.checked,id:"topic-".concat(e._id),onChange:ne})},t)}))}),(0,w.jsx)(d.Z.Control.Feedback,{type:"invalid",children:_.name})]}),(0,w.jsxs)(d.Z.Group,{className:"mb-3",children:[(0,w.jsx)(d.Z.Label,{children:"SubTopic:"}),(0,w.jsx)("br",{}),(0,w.jsx)(u.Z,{children:Q.map((function(e,t){return e.shown&&(0,w.jsx)(m.Z,{sm:6,children:(0,w.jsx)(d.Z.Check,{inline:!0,label:e.name,name:"module-item",value:e._id,type:"checkbox",checked:e.checked,id:"subTopic-".concat(e._id),onChange:se})},t)}))}),(0,w.jsx)(d.Z.Control.Feedback,{type:"invalid",children:_.name})]}),(0,w.jsxs)(d.Z.Group,{className:"mb-3",children:[(0,w.jsx)(d.Z.Check,{inline:!0,type:"radio",name:"permission",label:"Open",id:"permission-1",value:"0",checked:0===f.permission,onChange:re,onBlur:h}),(0,w.jsx)(d.Z.Check,{inline:!0,type:"radio",name:"permission",label:"Free",id:"permission-2",value:"1",checked:1===f.permission,onChange:re,onBlur:h}),(0,w.jsx)(d.Z.Check,{inline:!0,type:"radio",name:"permission",label:"Premium",id:"permission-3",value:"2",checked:2===f.permission,onChange:re,onBlur:h})]}),(0,w.jsxs)(d.Z.Group,{className:"mb-3",children:[(0,w.jsx)(d.Z.Label,{children:"Question:"}),(0,w.jsx)(Z.M,{tinymceScriptSrc:"/tinymce/tinymce.min.js",onInit:function(e,i){return t.current=i},init:(s={height:150,menubar:!1,selector:"textarea",block_unsupported_drop:!1,automatic_uploads:!0,file_picker_callback:function(e,t,i){"file"==i.filetype&&e("mypage.html",{text:"My text"}),"image"==i.filetype&&e("myimage.jpg",{alt:"My alt text"}),"media"==i.filetype&&e("movie.mp4",{source2:"alt.ogg",poster:"image.jpg"})},plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","insertdatetime media table paste code help wordcount","grid","tiny_mce_wiris","code","table","link","media","codesample"],toolbar:"undo redo | formatselect | bold italic backcolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | removeformat | grid_insert | tiny_mce_wiris_formulaEditor tiny_mce_wiris_formulaEditorChemistry | help | image",images_upload_handler:g.Z,images_upload_credentials:!0,paste_data_images:!0,paste_as_text:!0},(0,a.Z)(s,"paste_data_images",!0),(0,a.Z)(s,"paste_enable_default_filters",!1),(0,a.Z)(s,"paste_postprocess",(function(e,t){t.node.querySelectorAll("img")})),(0,a.Z)(s,"draggable_modal",!0),(0,a.Z)(s,"content_style","body { font-family:Helvetica,Arial,sans-serif; font-size:14px }"),s),name:"content",initialValue:f.name}),(0,w.jsx)(d.Z.Control.Feedback,{type:"invalid",children:_.name})]})]}),(0,w.jsxs)(m.Z,{md:6,children:[(0,w.jsxs)(d.Z.Group,{className:"mb-3",children:[(0,w.jsx)(d.Z.Label,{children:"Total marks:"}),(0,w.jsx)(d.Z.Control,{type:"text",placeholder:"Please enter total marks.",name:"totalMarks",onChange:oe,onBlur:h,value:f.totalMarks,touched:b,isInvalid:!!_.totalMarks}),(0,w.jsx)(d.Z.Control.Feedback,{type:"invalid",children:_.totalMarks})]}),(0,w.jsxs)(d.Z.Group,{className:"mb-3",children:[(0,w.jsx)(d.Z.Label,{children:"Syllabus reference:"}),(0,w.jsx)(d.Z.Control,{type:"text",placeholder:"Please enter syllabus reference.",name:"syllabusRef",onChange:le,onBlur:h,value:f.syllabusRef,touched:b,isInvalid:!!_.syllabusRef}),(0,w.jsx)(d.Z.Control.Feedback,{type:"invalid",children:_.syllabusRef})]}),(0,w.jsxs)(d.Z.Group,{className:"mb-3",children:[(0,w.jsx)(d.Z.Label,{children:"Marking criteria:"}),(0,w.jsx)(Z.M,{tinymceScriptSrc:"/tinymce/tinymce.min.js",onInit:function(e,t){return i.current=t},init:(r={height:150,menubar:!1,selector:"textarea",block_unsupported_drop:!1,automatic_uploads:!0,file_picker_callback:function(e,t,i){"file"==i.filetype&&e("mypage.html",{text:"My text"}),"image"==i.filetype&&e("myimage.jpg",{alt:"My alt text"}),"media"==i.filetype&&e("movie.mp4",{source2:"alt.ogg",poster:"image.jpg"})},plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","insertdatetime media table paste code help wordcount","grid","tiny_mce_wiris","code","table","link","media","codesample"],toolbar:"undo redo | formatselect | bold italic backcolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | removeformat | grid_insert | tiny_mce_wiris_formulaEditor tiny_mce_wiris_formulaEditorChemistry | help | image",images_upload_handler:g.Z,images_upload_credentials:!0,paste_data_images:!0,paste_as_text:!0},(0,a.Z)(r,"paste_data_images",!0),(0,a.Z)(r,"paste_enable_default_filters",!1),(0,a.Z)(r,"paste_postprocess",(function(e,t){t.node.querySelectorAll("img")})),(0,a.Z)(r,"draggable_modal",!0),(0,a.Z)(r,"content_style","body { font-family:Helvetica,Arial,sans-serif; font-size:14px }"),r),name:"description",initialValue:f.markingCrit}),(0,w.jsx)(d.Z.Control.Feedback,{type:"invalid",children:_.markingCrit})]}),(0,w.jsxs)(d.Z.Group,{className:"mb-3",children:[(0,w.jsx)(d.Z.Label,{children:"Sample solution:"}),(0,w.jsx)(Z.M,{tinymceScriptSrc:"/tinymce/tinymce.min.js",onInit:function(e,t){return x.current=t},init:(l={height:150,menubar:!1,selector:"textarea",block_unsupported_drop:!1,automatic_uploads:!0,file_picker_callback:function(e,t,i){"file"==i.filetype&&e("mypage.html",{text:"My text"}),"image"==i.filetype&&e("myimage.jpg",{alt:"My alt text"}),"media"==i.filetype&&e("movie.mp4",{source2:"alt.ogg",poster:"image.jpg"})},plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","insertdatetime media table paste code help wordcount","grid","tiny_mce_wiris","code","table","link","media","codesample"],toolbar:"undo redo | formatselect | bold italic backcolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | removeformat | grid_insert | tiny_mce_wiris_formulaEditor tiny_mce_wiris_formulaEditorChemistry | help | image",images_upload_handler:g.Z,images_upload_credentials:!0,paste_data_images:!0,paste_as_text:!0},(0,a.Z)(l,"paste_data_images",!0),(0,a.Z)(l,"paste_enable_default_filters",!1),(0,a.Z)(l,"paste_postprocess",(function(e,t){t.node.querySelectorAll("img")})),(0,a.Z)(l,"draggable_modal",!0),(0,a.Z)(l,"content_style","body { font-family:Helvetica,Arial,sans-serif; font-size:14px }"),l),name:"description",initialValue:f.sampleSolution}),(0,w.jsx)(d.Z.Control.Feedback,{type:"invalid",children:_.sampleSolution})]}),(0,w.jsxs)(d.Z.Group,{className:"mb-3",children:[(0,w.jsx)(d.Z.Label,{children:"Tags:"}),(0,w.jsx)(j(),{value:K.tags,onChange:ce}),(0,w.jsx)(d.Z.Control.Feedback,{type:"invalid",children:_.tags})]})]})]}),(0,w.jsxs)(d.Z.Group,{className:"mb-3",children:[(0,w.jsx)(d.Z.Label,{children:"Description:"}),(0,w.jsx)(Z.M,{tinymceScriptSrc:"/tinymce/tinymce.min.js",onInit:function(t,i){return e.current=i},init:(o={height:450,menubar:!0,selector:"textarea",block_unsupported_drop:!1,automatic_uploads:!0,file_picker_callback:function(e,t,i){"file"==i.filetype&&e("mypage.html",{text:"My text"}),"image"==i.filetype&&e("myimage.jpg",{alt:"My alt text"}),"media"==i.filetype&&e("movie.mp4",{source2:"alt.ogg",poster:"image.jpg"})},plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","insertdatetime media table paste code help wordcount","grid","tiny_mce_wiris","code","table","link","media","codesample"],toolbar:"undo redo | formatselect | bold italic backcolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | removeformat | grid_insert | tiny_mce_wiris_formulaEditor tiny_mce_wiris_formulaEditorChemistry | help | image",images_upload_handler:g.Z,images_upload_credentials:!0,paste_data_images:!0,paste_as_text:!0},(0,a.Z)(o,"paste_data_images",!0),(0,a.Z)(o,"paste_enable_default_filters",!1),(0,a.Z)(o,"paste_postprocess",(function(e,t){t.node.querySelectorAll("img")})),(0,a.Z)(o,"draggable_modal",!0),(0,a.Z)(o,"content_style","body { font-family:Helvetica,Arial,sans-serif; font-size:14px }"),o),name:"content",initialValue:f.content})]}),(0,w.jsxs)(p.Z,{type:"submit",variant:"primary",className:"float-end",children:[(0,w.jsx)("i",{className:"fa fa-save"})," Save"]})]})}})})]})})}}}]);