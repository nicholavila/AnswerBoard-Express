"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[5442],{35442:function(e,t,n){n.r(t);var s=n(4942),i=n(74165),a=n(1413),o=n(15861),l=n(70885),r=n(47313),c=n(65832),u=n(21366),d=n(93298),m=n(7410),p=n(3463),h=n(24751),b=n(3979),g=n(34491),j=n(58467),Z=n(7155),f=n(76666),v=n.n(f),x=n(46417),_=document.createElement("script");_.type="text/javascript",_.src="https://www.wiris.net/demo/plugins/app/WIRISplugins.js?viewer=image",document.head.appendChild(_),window.$=v(),window.tinymce=n(86821),n(37741);t.default=function(){var e=(0,j.UO)(),t=(0,r.useRef)(null),n=(0,j.s0)(),f=(0,r.useState)([]),v=(0,l.Z)(f,2),_=v[0],y=v[1],C=(0,r.useState)([]),k=(0,l.Z)(C,2),w=k[0],S=k[1],T=(0,r.useState)([]),q=(0,l.Z)(T,2),I=q[0],N=q[1],B=(0,r.useState)([]),E=(0,l.Z)(B,2),F=E[0],M=E[1],P=(0,r.useState)({no:"",year:"",subject:"",module:"",topic:"",name:"",content:"",permission:0}),G=(0,l.Z)(P,2),L=G[0],O=G[1],R=p.Ry({no:p.Rx().typeError("Must be a number.").required("Please enter a order.").test("","Must be between 1 and 99.",(function(e){return e||(e=0),!(e<1||e>99)})),year:p.Z_("Choose a year.").required("Year is required."),subject:p.Z_("Choose a subject.").required("Subject is required"),module:p.Z_("Choose a module.").required("Module is required."),topic:p.Z_("Choose a topic.").required("Topic is required."),name:p.Z_("Enter a subtopic name.").test("len","Must be less than or equal to 64 characters.",(function(e){return e||(e=""),e.length<=64})).required("Please enter a name.")});(0,r.useEffect)((function(){(0,o.Z)((0,i.Z)().mark((function e(){var t,n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.Z.get("/admin/years/get-all-populate");case 2:t=e.sent,n=t.data,y(n),S(n.length?n[0].subjects:[]),N(n.length&&n[0].subjects.length?n[0].subjects[0].modules:[]),M(n.length&&n[0].subjects.length&&n[0].subjects[0].modules.length?n[0].subjects[0].modules[0].topics:[]),O((0,a.Z)((0,a.Z)({},L),{},{year:n.length?n[0]._id:"",subject:n.length&&n[0].subjects.length?n[0].subjects[0]._id:"",module:n.length&&n[0].subjects.length&&n[0].subjects[0].modules.length?n[0].subjects[0].modules[0]._id:"",topic:n.length&&n[0].subjects.length&&n[0].subjects[0].modules.length&&n[0].subjects[0].modules[0].topics.length?n[0].subjects[0].modules[0].topics[0]._id:""}));case 9:case"end":return e.stop()}}),e)})))()}),[]),(0,r.useEffect)((function(){(0,o.Z)((0,i.Z)().mark((function t(){var n,s,o;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.id,t.next=3,h.Z.get("/admin/sub-topics/".concat(n));case 3:s=t.sent,(o=s.data).success?O((0,a.Z)((0,a.Z)({},L),{},{no:o.data.no,year:o.data.topic.module.subject.year._id,subject:o.data.topic.module.subject._id,module:o.data.topic.module._id,topic:o.data.topic._id,name:o.data.name,content:o.data.content,permission:o.data.permission})):g.Am.error(o.msg);case 6:case"end":return t.stop()}}),t)})))()}),[]);var A=function(e){var t,n=_.findIndex((function(t){return t._id===e.target.value}));t=_.length>n&&_[n].subjects.length>0&&_[n].subjects[0].modules.length>0&&_[n].subjects[0].modules[0].topics.length>0&&_[n].subjects[0].modules[0].topics[0].subTopics.length>0?_[n].subjects[0].modules[0].topics[0].subTopics[0].no:0,S(_[n].subjects),N(_[n].subjects.length?_[n].subjects[0].modules:[]),M(_[n].subjects.length&&_[n].subjects[0].modules.length?_[n].subjects[0].modules[0].topics:[]),O((0,a.Z)((0,a.Z)({},L),{},{year:e.target.value,subject:_[n].subjects.length?_[n].subjects[0]._id:"",module:_[n].subjects.length&&_[n].subjects[0].modules.length?_[n].subjects[0].modules[0]._id:"",topic:_[n].subjects.length&&_[n].subjects[0].modules.length&&_[n].subjects[0].modules[0].topics.length?_[n].subjects[0].modules[0].topics[0]._id:"",no:t+1}))},H=function(e){var t,n=w.findIndex((function(t){return t._id===e.target.value}));t=w.length>n&&w[n].modules.length>0&&w[n].modules[0].topics.length>0&&w[n].modules[0].topics[0].subTopics.length>0?w[n].modules[0].topics[0].subTopics[0].no:0,N(w[n].modules),M(w[n].modules.length?w[n].modules[0].topics:[]),O((0,a.Z)((0,a.Z)({},L),{},{subject:e.target.value,module:w[n].modules.length?w[n].modules[0]._id:"",topic:w[n].modules.length&&w[n].modules[0].topics.length?w[n].modules[0].topics[0]._id:"",no:t+1}))},J=function(e){var t,n=I.findIndex((function(t){return t._id===e.target.value}));t=I.length>n&&I[n].topics.length>0&&I[n].topics[0].subTopics.length>0?I[n].topics[0].subTopics[0].no:0,M(I[n].topics),O((0,a.Z)((0,a.Z)({},L),{},{module:e.target.value,topic:I[n].topics.length?I[n].topics[0]._id:"",no:t+1}))},V=function(e){var t,n=F.findIndex((function(t){return t._id===e.target.value}));t=F.length>n&&F[n].subTopics.length>0?F[n].subTopics[0].no:0,O((0,a.Z)((0,a.Z)({},L),{},{topic:e.target.value,no:t+1}))},z=function(e){O((0,a.Z)((0,a.Z)({},L),{},{permission:Number(e.target.value)}))},D=function(){var s=(0,o.Z)((0,i.Z)().mark((function s(a,o){var l,r,c,u;return(0,i.Z)().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return l=o.resetForm,r=e.id,a.content=t.current.getContent(),s.next=5,h.Z.put("admin/sub-topics/".concat(r),a);case 5:c=s.sent,(u=c.data).success?(g.Am.success(u.msg),l(),n("/admin/subtopics")):g.Am.error(u.msg);case 8:case"end":return s.stop()}}),s)})));return function(e,t){return s.apply(this,arguments)}}();return(0,x.jsxs)(c.Z,{children:[(0,x.jsx)(c.Z.Header,{style:{background:"#3c4b64"},bsPrefix:"card-header py-3",children:(0,x.jsx)(c.Z.Title,{bsPrefix:"card-title mb-0 text-light",as:"h1",children:"Edit subtopic"})}),(0,x.jsx)(c.Z.Body,{children:(0,x.jsx)(m.J9,{validationSchema:R,validateOnChange:!1,validateOnBlur:!1,onSubmit:D,initialValues:L,enableReinitialize:!0,children:function(e){var n,i=e.handleSubmit,a=e.handleChange,o=e.handleBlur,l=e.values,r=e.touched,c=e.errors;return(0,x.jsxs)(u.Z,{noValidate:!0,onSubmit:i,children:[(0,x.jsxs)(u.Z.Group,{className:"mb-3",children:[(0,x.jsx)(u.Z.Label,{children:"Year:"}),(0,x.jsx)(u.Z.Select,{name:"year",value:l.year,onChange:A,onBlur:o,touched:r,isInvalid:!!c.year,children:_.map((function(e,t){return(0,x.jsx)("option",{value:e._id,children:e.name},t)}))}),(0,x.jsx)(u.Z.Control.Feedback,{type:"invalid",children:c.year})]}),(0,x.jsxs)(u.Z.Group,{className:"mb-3",children:[(0,x.jsx)(u.Z.Label,{children:"Subject:"}),(0,x.jsx)(u.Z.Select,{name:"subject",value:l.subject,onChange:H,onBlur:o,touched:r,isInvalid:!!c.subject,children:w.map((function(e,t){return(0,x.jsx)("option",{value:e._id,children:e.name},t)}))}),(0,x.jsx)(u.Z.Control.Feedback,{type:"invalid",children:c.subject})]}),(0,x.jsxs)(u.Z.Group,{className:"mb-3",children:[(0,x.jsx)(u.Z.Label,{children:"Module:"}),(0,x.jsx)(u.Z.Select,{name:"module",value:l.module,onChange:J,onBlur:o,touched:r,isInvalid:!!c.module,children:I.map((function(e,t){return(0,x.jsx)("option",{value:e._id,children:e.name},t)}))}),(0,x.jsx)(u.Z.Control.Feedback,{type:"invalid",children:c.module})]}),(0,x.jsxs)(u.Z.Group,{className:"mb-3",children:[(0,x.jsx)(u.Z.Label,{children:"Topic:"}),(0,x.jsx)(u.Z.Select,{name:"topic",value:L.topic,onChange:V,onBlur:o,touched:r,isInvalid:!!c.topic,children:F.map((function(e,t){return(0,x.jsx)("option",{value:e._id,children:e.name},t)}))}),(0,x.jsx)(u.Z.Control.Feedback,{type:"invalid",children:c.topic})]}),(0,x.jsxs)(u.Z.Group,{className:"mb-3",children:[(0,x.jsx)(u.Z.Label,{children:"Order:"}),(0,x.jsx)(u.Z.Control,{type:"text",placeholder:"Please enter a subtopic order.",name:"no",onChange:a,onBlur:o,value:l.no,touched:r,isInvalid:!!c.no}),(0,x.jsx)(u.Z.Control.Feedback,{type:"invalid",children:c.no})]}),(0,x.jsxs)(u.Z.Group,{className:"mb-3",children:[(0,x.jsx)(u.Z.Label,{children:"Name:"}),(0,x.jsx)(u.Z.Control,{type:"text",placeholder:"Please enter a subtopic name.",name:"name",onChange:a,onBlur:o,value:l.name,touched:r,isInvalid:!!c.name}),(0,x.jsx)(u.Z.Control.Feedback,{type:"invalid",children:c.name})]}),(0,x.jsxs)(u.Z.Group,{className:"mb-3",children:[(0,x.jsx)(u.Z.Check,{inline:!0,type:"radio",name:"permission",label:"Open",id:"permission-1",value:"0",checked:0===l.permission,onChange:z,onBlur:o}),(0,x.jsx)(u.Z.Check,{inline:!0,type:"radio",name:"permission",label:"Free",id:"permission-2",value:"1",checked:1===l.permission,onChange:z,onBlur:o}),(0,x.jsx)(u.Z.Check,{inline:!0,type:"radio",name:"permission",label:"Premium",id:"permission-3",value:"2",checked:2===l.permission,onChange:z,onBlur:o})]}),(0,x.jsxs)(u.Z.Group,{className:"mb-3",children:[(0,x.jsx)(u.Z.Label,{children:"Description:"}),(0,x.jsx)(Z.M,{tinymceScriptSrc:"/tinymce/tinymce.min.js",onInit:function(e,n){return t.current=n},init:(n={height:450,menubar:!0,selector:"textarea",block_unsupported_drop:!1,automatic_uploads:!0,file_picker_callback:function(e,t,n){"file"===n.filetype&&e("mypage.html",{text:"My text"}),"image"===n.filetype&&e("myimage.jpg",{alt:"My alt text"}),"media"===n.filetype&&e("movie.mp4",{source2:"alt.ogg",poster:"image.jpg"})},plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","insertdatetime media table paste code help wordcount","grid","tiny_mce_wiris","code","table","link","media","codesample"],toolbar:"undo redo | formatselect | bold italic backcolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | removeformat | grid_insert | tiny_mce_wiris_formulaEditor tiny_mce_wiris_formulaEditorChemistry | help | image",images_upload_handler:b.Z,images_upload_credentials:!0,paste_data_images:!0,paste_as_text:!0},(0,s.Z)(n,"paste_data_images",!0),(0,s.Z)(n,"paste_enable_default_filters",!1),(0,s.Z)(n,"paste_postprocess",(function(e,t){t.node.querySelectorAll("img")})),(0,s.Z)(n,"draggable_modal",!0),(0,s.Z)(n,"content_style","body { font-family:Helvetica,Arial,sans-serif; font-size:14px }"),n),name:"content",initialValue:l.content})]}),(0,x.jsxs)(d.Z,{type:"submit",variant:"primary",className:"float-end",children:[(0,x.jsx)("i",{className:"fa fa-save"})," Save"]})]})}})})]})}},3979:function(e,t,n){var s=n(74165),i=n(15861),a=function(){var e=(0,i.Z)((0,s.Z)().mark((function e(t,n,i){var a,o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(a=new XMLHttpRequest).withCredentials=!1,a.open("POST","https://answersheet.au/api/v1/admin/questions/image"),a.onload=function(){var e;200===a.status?(e=JSON.parse(a.responseText))&&"string"===typeof e.location?n(e.location):i("Invalid JSON: "+a.responseText):i("HTTP Error: "+a.status)},(o=new FormData).append("file",t.blob(),t.filename()),a.send(o);case 7:case"end":return e.stop()}}),e)})));return function(t,n,s){return e.apply(this,arguments)}}();t.Z=a}}]);